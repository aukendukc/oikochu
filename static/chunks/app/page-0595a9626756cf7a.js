(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5498:function(e,t,a){Promise.resolve().then(a.bind(a,7719))},4817:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.436.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,a(8030).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},7719:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var l=a(7437),r=a(666),s=a(2265),o=a(9842),n=a(2574),i=a(6463);a(5735);var c=a(9854);let d=async(e,t)=>{try{console.log("アップロード開始:",t);let a=(0,c.iH)(n.tO,t),l={contentType:e.type,cacheControl:"public,max-age=31536000"};console.log("ファイルをアップロード中...");let r=await (0,c.KV)(a,e,l);console.log("アップロード完了:",r),console.log("ダウンロードURLを取得中...");let s=await (0,c.Jt)(r.ref);return console.log("ダウンロードURL取得成功:",s),s}catch(e){throw console.error("Storage upload error:",e),Error("画像のアップロードに失敗しました: ".concat(e instanceof Error?e.message:"不明なエラー"))}};var u=a(419),g=a(4817),x=a(4697);/**
 * @license lucide-react v0.436.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,a(8030).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var m=a(6648);function b(e){let{onImageChange:t}=e,[a,r]=(0,s.useState)(null),[o,i]=(0,s.useState)(null),c=(0,s.useRef)(null);return(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center w-full",children:[o&&(0,l.jsx)("div",{className:"w-full mb-2 p-2 bg-red-100 text-red-700 rounded",children:o}),a?(0,l.jsxs)("div",{className:"relative w-full h-64",children:[(0,l.jsx)(m.default,{src:a,alt:"Preview",layout:"fill",objectFit:"cover",className:"rounded-lg"}),(0,l.jsx)("button",{type:"button",onClick:()=>{t(null),r(null),i(null),c.current&&(c.current.value="")},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600",children:(0,l.jsx)(x.Z,{size:20})})]}):(0,l.jsx)("label",{htmlFor:"image",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,l.jsx)(h,{className:"w-10 h-10 mb-3 text-gray-400"}),(0,l.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[(0,l.jsx)("span",{className:"font-semibold",children:"クリックしてアップロード"})," または ドラッグ＆ドロップ"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"JPG、PNG、GIF形式（5MB以下）"})]})}),(0,l.jsx)("input",{type:"file",id:"image",accept:"image/jpeg,image/png,image/gif",onChange:e=>{var a;let l=null===(a=e.target.files)||void 0===a?void 0:a[0];if(i(null),l){if(!n.I8.currentUser){i("画像をアップロードするにはログインが必要です");return}if(l.size>5242880){i("ファイルサイズは5MB以下にしてください");return}if(!["image/jpeg","image/png","image/gif"].includes(l.type)){i("JPG、PNG、またはGIF形式の画像をアップロードしてください");return}t(l);let e=new FileReader;e.onloadend=()=>{r(e.result)},e.onerror=()=>{i("画像の読み込みに失敗しました")},e.readAsDataURL(l)}},className:"hidden",ref:c})]})}function p(e){let{location:t,onClose:a,onSuccess:r}=e,[i,c]=(0,s.useState)(""),[x,h]=(0,s.useState)(""),[m,p]=(0,s.useState)("new"),[f,y]=(0,s.useState)(""),[j,v]=(0,s.useState)(null),[w,k]=(0,s.useState)("new"),[N,S]=(0,s.useState)([]),[C,E]=(0,s.useState)(""),[L,F]=(0,s.useState)([]),[I,M]=(0,s.useState)(""),[O,P]=(0,s.useState)(""),[G,z]=(0,s.useState)(!1),[D,R]=(0,s.useState)(0);(0,s.useEffect)(()=>{(async()=>{try{let e=(0,o.IO)((0,o.hJ)(n.db,"homelessPeople")),t=await (0,o.PL)(e),a=[];t.forEach(e=>{a.push({id:e.id,...e.data()})}),S(a),F(a)}catch(e){console.error("Error fetching people:",e)}})()},[]),(0,s.useEffect)(()=>{""===I.trim()?F(N):F(N.filter(e=>e.nickname.toLowerCase().includes(I.toLowerCase())||e.features&&e.features.toLowerCase().includes(I.toLowerCase())))},[I,N]);let U=async e=>{if(e.preventDefault(),!i.trim()){alert("ニックネームを入力してください");return}z(!0);try{let e="";if(j)try{if(!n.I8.currentUser)throw Error("画像をアップロードするにはログインが必要です");console.log("画像アップロード開始:",j.name);let t=j.name.split(".").pop(),a="profile-images/".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,15),".").concat(t);console.log("アップロードパス:",a),e=await d(j,a),console.log("画像のアップロードに成功しました:",e)}catch(e){console.error("画像のアップロードに失敗しました:",e),alert("画像のアップロードに失敗しました: ".concat(e instanceof Error?e.message:"不明なエラー")),z(!1);return}console.log("Firestoreにデータを追加中..."),await (0,o.ET)((0,o.hJ)(n.db,"homelessPeople"),{nickname:i,ageGroup:x||"不明",category:m,features:f,photoURL:e,locations:[{latitude:t.lat,longitude:t.lng,description:"",timestamp:new Date().toISOString()}],lastSeen:(0,u.WU)(new Date,"yyyy/MM/dd HH:mm"),createdAt:new Date().toISOString()}),console.log("データの追加が完了しました"),r()}catch(e){console.error("Error adding person:",e),alert("エラーが発生しました: ".concat(e instanceof Error?e.message:"不明なエラー"))}finally{z(!1)}},J=async e=>{if(e.preventDefault(),!C){alert("人を選択してください");return}z(!0);try{let e=(0,o.JU)(n.db,"homelessPeople",C),a=N.find(e=>e.id===C);if(!a)throw Error("選択された人が見つかりません");let l=a.locations||[];!l.length&&a.location&&(l=[{latitude:a.location.latitude,longitude:a.location.longitude,description:"元の位置",timestamp:new Date().toISOString()}]),l.push({latitude:t.lat,longitude:t.lng,description:O,timestamp:new Date().toISOString()}),await (0,o.r7)(e,{locations:l,lastSeen:(0,u.WU)(new Date,"yyyy/MM/dd HH:mm")}),r()}catch(e){console.error("Error updating person:",e),alert("エラーが発生しました。もう一度お試しください。")}finally{z(!1)}};return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-full max-w-md",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsxs)("div",{className:"flex border-b dark:border-gray-700",children:[(0,l.jsx)("button",{className:"py-2 px-4 text-gray-800 dark:text-gray-200 ".concat("new"===w?"border-b-2 border-blue-500 font-bold":""),onClick:()=>k("new"),children:"新規登録"}),(0,l.jsx)("button",{className:"py-2 px-4 text-gray-800 dark:text-gray-200 ".concat("existing"===w?"border-b-2 border-blue-500 font-bold":""),onClick:()=>k("existing"),children:"既存登録者に追加"})]})}),"new"===w?(0,l.jsxs)("form",{onSubmit:U,children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"新規登録"}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"nickname",children:"ニックネーム *"}),(0,l.jsx)("input",{id:"nickname",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:i,onChange:e=>c(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"ageGroup",children:"年齢層"}),(0,l.jsxs)("select",{id:"ageGroup",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:x,onChange:e=>h(e.target.value),children:[(0,l.jsx)("option",{value:"",children:"不明"}),(0,l.jsx)("option",{value:"10代",children:"10代"}),(0,l.jsx)("option",{value:"20代",children:"20代"}),(0,l.jsx)("option",{value:"30代",children:"30代"}),(0,l.jsx)("option",{value:"40代",children:"40代"}),(0,l.jsx)("option",{value:"50代",children:"50代"}),(0,l.jsx)("option",{value:"60代",children:"60代"}),(0,l.jsx)("option",{value:"70代以上",children:"70代以上"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"category",children:"カテゴリ"}),(0,l.jsxs)("select",{id:"category",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:m,onChange:e=>p(e.target.value),children:[(0,l.jsx)("option",{value:"new",children:"新規（緑）"}),(0,l.jsx)("option",{value:"occasional",children:"たまに会う（黄）"}),(0,l.jsx)("option",{value:"regular",children:"定期的に会う（赤）"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"features",children:"特徴"}),(0,l.jsx)("textarea",{id:"features",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:f,onChange:e=>y(e.target.value),rows:3})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"プロフィール画像"}),(0,l.jsx)(b,{onImageChange:e=>{v(e)}})]}),(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["位置情報：緯度 ",t.lat.toFixed(6),", 経度 ",t.lng.toFixed(6)]})}),(0,l.jsxs)("div",{className:"flex justify-end",children:[(0,l.jsx)("button",{type:"button",onClick:a,className:"bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-bold py-2 px-4 rounded focus:shadow-outline mr-2",children:"キャンセル"}),(0,l.jsx)("button",{type:"submit",disabled:G,className:"bg-blue-500 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-800 text-white font-bold py-2 px-4 rounded focus:shadow-outline",children:G?"登録中...":"登録"})]})]}):(0,l.jsxs)("form",{onSubmit:J,children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"既存の人に場所を追加"}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"登録者を検索"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,l.jsx)(g.Z,{className:"h-5 w-5 text-gray-400"})}),(0,l.jsx)("input",{type:"text",className:"shadow appearance-none border rounded w-full pl-10 py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"名前や特徴で検索...",value:I,onChange:e=>M(e.target.value)})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"登録者を選択 *"}),(0,l.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded max-h-40 overflow-y-auto p-2",children:L.length>0?L.map(e=>(0,l.jsx)("div",{className:"p-2 mb-1 rounded cursor-pointer ".concat(C===e.id?"bg-blue-100 dark:bg-blue-900":"hover:bg-gray-200 dark:hover:bg-gray-600"),onClick:()=>E(e.id),children:(0,l.jsxs)("div",{className:"flex items-center",children:[e.photoURL&&(0,l.jsx)("img",{src:e.photoURL,alt:e.nickname,className:"w-8 h-8 rounded-full mr-2 object-cover"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium text-gray-800 dark:text-white",children:e.nickname}),e.features&&(0,l.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:e.features})]})]})},e.id)):(0,l.jsx)("div",{className:"text-center p-2 text-gray-500 dark:text-gray-400",children:0===N.length?"登録された人がいません":"該当する人が見つかりません"})})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"locationDescription",children:"位置情報の説明"}),(0,l.jsx)("input",{id:"locationDescription",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"例: 昼間の居場所、夜間の寝床",value:O,onChange:e=>P(e.target.value)})]}),(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["位置情報：緯度 ",t.lat.toFixed(6),", 経度 ",t.lng.toFixed(6)]})}),(0,l.jsxs)("div",{className:"flex justify-end",children:[(0,l.jsx)("button",{type:"button",onClick:a,className:"bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-bold py-2 px-4 rounded focus:shadow-outline mr-2",children:"キャンセル"}),(0,l.jsx)("button",{type:"submit",disabled:G||!C,className:"bg-blue-500 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-800 text-white font-bold py-2 px-4 rounded focus:shadow-outline disabled:opacity-50",children:G?"追加中...":"場所を追加"})]})]})]})})}var f=a(6848);function y(){let e=(0,s.useRef)(null),[t,a]=(0,s.useState)(null),[c,d]=(0,s.useState)([]),[u,g]=(0,s.useState)([]),[x,h]=(0,s.useState)(null),[m,b]=(0,s.useState)(!1),[y,j]=(0,s.useState)(null),[v,w]=(0,s.useState)(!1),[k,N]=(0,s.useState)(null),{user:S}=(0,r.a)(),C=(0,i.useSearchParams)(),[E,L]=(0,s.useState)(null),F=(0,s.useRef)(null),I=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{let a={lat:e.coords.latitude,lng:e.coords.longitude};if(L(a),t){t.setCenter(a),t.setZoom(16),F.current&&F.current.setMap(null);let e=new google.maps.Marker({position:a,map:t,title:"現在地",icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#4285F4",fillOpacity:1,strokeWeight:2,strokeColor:"#FFFFFF",scale:8}});F.current=e}},e=>{console.error("位置情報の取得に失敗しました:",e),alert("位置情報の取得に失敗しました。ブラウザの位置情報へのアクセスを許可してください。")}):alert("お使いのブラウザは位置情報をサポートしていません。")};(0,s.useEffect)(()=>{let t=async()=>{if(!e.current)return;let t=C.get("lat"),l=C.get("lng"),r=t&&l?{lat:parseFloat(t),lng:parseFloat(l)}:{lat:35.6896,lng:139.7006},s=new google.maps.Map(e.current,{center:r,zoom:t&&l?18:16,mapTypeControl:!0,streetViewControl:!0,fullscreenControl:!0});a(s),t&&l&&new google.maps.Marker({position:r,map:s,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"blue",fillOpacity:.8,strokeWeight:1,strokeColor:"#ffffff",scale:8}}),google.maps.event.addListener(s,"click",e=>{if(S&&e.latLng){let t={lat:e.latLng.lat(),lng:e.latLng.lng()};h(null),w(!1),j(t),b(!0)}}),I()},l=document.createElement("script");return l.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyAdNLfgQAJfnY3JTv561hOYG9nvTLqG5YI","&libraries=places"),l.async=!0,l.defer=!0,l.onload=t,document.head.appendChild(l),()=>{l.parentNode&&l.parentNode.removeChild(l)}},[S,C]),(0,s.useEffect)(()=>{let e=e=>{if(!t)return;let{latitude:a,longitude:l}=e.detail,r={lat:a,lng:l};t.setCenter(r),t.setZoom(18);let s=new google.maps.Marker({position:r,map:t,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"blue",fillOpacity:.8,strokeWeight:1,strokeColor:"#ffffff",scale:8}});setTimeout(()=>{s.setMap(null)},3e3)};return window.addEventListener("show-location",e),()=>{window.removeEventListener("show-location",e)}},[t]),(0,s.useEffect)(()=>{if(!S)return;let e=(0,o.IO)((0,o.hJ)(n.db,"homelessPeople")),t=(0,o.cf)(e,e=>{let t=[];e.forEach(e=>{let a=e.data();t.push({id:e.id,...a})}),g(t)});return()=>t()},[S]),(0,s.useEffect)(()=>{if(!t)return;c.forEach(e=>e.setMap(null));let e=[],a={};u.forEach(e=>{let t=[];e.locations&&e.locations.length>0?t=e.locations:e.location&&(t=[{latitude:e.location.latitude,longitude:e.location.longitude,description:"元の位置",timestamp:new Date().toISOString()}]),t.forEach(t=>{let l="".concat(t.latitude.toFixed(6),",").concat(t.longitude.toFixed(6));a[l]||(a[l]=[]),a[l].push({person:e,location:t})})}),Object.entries(a).forEach(a=>{let[l,r]=a,[s,o]=l.split(",").map(Number),n=r[0].person.category,i={regular:"#ef4444",occasional:"#eab308",new:"#22c55e"},c=i[n]||i.new,d=r.length>1?"".concat(r.length,"人のホームレス者がこの場所にいます"):"".concat(r[0].person.nickname," - ").concat(r[0].location.description||"位置情報"),u=new google.maps.Marker({position:{lat:s,lng:o},map:t,title:d,icon:{path:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fillColor:c,fillOpacity:1,strokeWeight:1,strokeColor:"#ffffff",scale:1.5,anchor:{x:12,y:24}}});u.addListener("click",()=>{r.length>1?(O(r),G(!0)):(h(r[0].person),N(r[0].person.id),w(!0))}),e.push(u)}),d(e)},[t,u]);let[M,O]=(0,s.useState)([]),[P,G]=(0,s.useState)(!1),z=e=>{h(e),N(e.id),w(!0),G(!1)};return(0,l.jsxs)("div",{className:"w-full h-[calc(100vh-64px)] relative",children:[(0,l.jsx)("div",{ref:e,className:"w-full h-full"}),(0,l.jsx)("button",{onClick:I,className:"absolute bottom-20 right-4 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg z-10 hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"現在位置に移動",title:"現在位置に移動",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),x&&!v&&(0,l.jsxs)("div",{className:"absolute bottom-4 left-4 right-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg z-10",children:[(0,l.jsx)("h2",{className:"text-xl font-bold dark:text-white",children:x.nickname}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["最終確認: ",x.lastSeen]}),x.ageGroup&&(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["年齢層: ",x.ageGroup]}),x.features&&(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["特徴: ",x.features]}),(0,l.jsxs)("div",{className:"flex justify-end mt-2",children:[(0,l.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700",onClick:()=>w(!0),children:"詳細を見る"}),(0,l.jsx)("button",{className:"ml-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white px-4 py-2 rounded hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>h(null),children:"閉じる"})]})]}),v&&k&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50 overflow-auto",children:(0,l.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto relative",children:[(0,l.jsxs)("div",{className:"p-3 sm:p-4 bg-blue-500 dark:bg-blue-700 text-white flex justify-between items-center sticky top-0",children:[(0,l.jsx)("h2",{className:"text-lg sm:text-xl font-bold",children:x?x.nickname:"詳細情報"}),(0,l.jsx)("button",{onClick:()=>{console.log("詳細ポップアップを閉じます"),w(!1)},className:"bg-white dark:bg-gray-200 text-blue-500 dark:text-blue-700 px-2 sm:px-3 py-1 rounded hover:bg-blue-100 dark:hover:bg-gray-300","data-close-popup":!0,children:"閉じる"})]}),(0,l.jsx)("div",{className:"p-3 sm:p-4",children:k?(0,l.jsx)(f.Z,{personId:k,isPopup:!0},k):(0,l.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"データを読み込めませんでした"})})]})}),P&&M.length>0&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-md p-3 sm:p-4",children:[(0,l.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4 dark:text-white",children:"この場所のホームレス者"}),(0,l.jsx)("div",{className:"max-h-60 overflow-y-auto",children:M.map((e,t)=>(0,l.jsxs)("div",{className:"p-2 sm:p-3 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>z(e.person),children:[(0,l.jsx)("h3",{className:"font-medium dark:text-white",children:e.person.nickname}),(0,l.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[e.location.description||"位置情報"," - ",e.person.lastSeen]})]},t))}),(0,l.jsx)("div",{className:"mt-3 sm:mt-4 flex justify-end",children:(0,l.jsx)("button",{className:"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white px-3 sm:px-4 py-2 rounded hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>{G(!1),O([])},children:"閉じる"})})]})}),m&&y&&(0,l.jsx)(p,{location:y,onClose:()=>b(!1),onSuccess:()=>{b(!1),j(null)}})]})}function j(){let{signInWithGoogle:e}=(0,r.a)();return(0,l.jsxs)("button",{onClick:e,className:"flex items-center justify-center bg-white text-gray-700 font-semibold py-2 px-4 rounded-full border border-gray-300 hover:bg-gray-100 transition duration-300 ease-in-out",children:[(0,l.jsx)("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google logo",className:"w-6 h-6 mr-2"}),"Sign in with Google"]})}var v=a(6504);function w(){let{user:e,loading:t}=(0,r.a)();return t?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):(0,l.jsx)("main",{className:"min-h-screen bg-gray-100 flex flex-col",children:e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.Z,{}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(y,{})})]}):(0,l.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-blue-50",children:(0,l.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl max-w-md w-full",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-center mb-6 text-blue-700",children:"OIKOS Support Map"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6 text-center",children:"新宿駅周辺の路上生活者支援活動の効率化と情報管理のためのアプリケーションです。"}),(0,l.jsxs)("div",{className:"bg-blue-100 p-4 rounded-lg mb-6",children:[(0,l.jsx)("h2",{className:"font-bold text-blue-800 mb-2",children:"主な機能"}),(0,l.jsxs)("ul",{className:"list-disc pl-5 text-blue-800",children:[(0,l.jsx)("li",{children:"路上生活者の居場所のマッピング"}),(0,l.jsx)("li",{children:"個人情報と対話内容の記録・管理"}),(0,l.jsx)("li",{children:"音声記録と自動要約による効率的な情報収集"})]})]}),(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)(j,{})})]})})})}}},function(e){e.O(0,[358,139,141,252,452,681,971,23,744],function(){return e(e.s=5498)}),_N_E=e.O()}]);