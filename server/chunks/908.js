exports.id=908,exports.ids=[908],exports.modules={93978:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},50446:(e,t,r)=>{Promise.resolve().then(r.bind(r,44260)),Promise.resolve().then(r.bind(r,62361))},58015:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var a=r(10326),s=r(17577),l=r(90434),d=r(35047),o=r(54733),n=r(62361),i=r(94935),c=r(29389),x=r(88378),h=r(71810);function u(){let{user:e,loading:t,signOut:r}=(0,o.a)(),{theme:u}=(0,n.F)(),m=(0,d.useRouter)(),[g,b]=(0,s.useState)(!1),y=async()=>{await r(),m.push("/")};return(0,a.jsxs)("nav",{className:"bg-blue-500 dark:bg-gray-800 text-white shadow-md",children:[a.jsx("div",{className:"max-w-6xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex",children:a.jsx("div",{className:"flex-shrink-0 flex items-center",children:a.jsx(l.default,{href:"/",className:"font-bold text-xl",children:"ホームレス支援"})})}),!t&&e&&(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-1",children:[(0,a.jsxs)(l.default,{href:"/",className:"py-2 px-3 hover:bg-blue-600 dark:hover:bg-gray-700 rounded flex items-center",children:[a.jsx(i.Z,{size:18,className:"mr-1"}),"マップ"]}),(0,a.jsxs)(l.default,{href:"/people",className:"py-2 px-3 hover:bg-blue-600 dark:hover:bg-gray-700 rounded flex items-center",children:[a.jsx(c.Z,{size:18,className:"mr-1"}),"リスト"]}),(0,a.jsxs)(l.default,{href:"/settings",className:"py-2 px-3 hover:bg-blue-600 dark:hover:bg-gray-700 rounded flex items-center",children:[a.jsx(x.Z,{size:18,className:"mr-1"}),"設定"]}),(0,a.jsxs)("button",{onClick:y,className:"py-2 px-3 hover:bg-blue-600 dark:hover:bg-gray-700 rounded flex items-center",children:[a.jsx(h.Z,{size:18,className:"mr-1"}),"ログアウト"]})]}),!t&&e&&a.jsx("div",{className:"md:hidden flex items-center",children:a.jsx("button",{onClick:()=>b(!g),className:"inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-blue-600 dark:hover:bg-gray-700 focus:outline-none",children:a.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g?a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]})}),g&&!t&&e&&a.jsx("div",{className:"md:hidden",children:(0,a.jsxs)("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-blue-500 dark:bg-gray-800",children:[(0,a.jsxs)(l.default,{href:"/",className:"block px-3 py-2 rounded text-white hover:bg-blue-600 dark:hover:bg-gray-700 flex items-center",onClick:()=>b(!1),children:[a.jsx(i.Z,{size:18,className:"mr-2"}),"マップ"]}),(0,a.jsxs)(l.default,{href:"/people",className:"block px-3 py-2 rounded text-white hover:bg-blue-600 dark:hover:bg-gray-700 flex items-center",onClick:()=>b(!1),children:[a.jsx(c.Z,{size:18,className:"mr-2"}),"リスト"]}),(0,a.jsxs)(l.default,{href:"/settings",className:"block px-3 py-2 rounded text-white hover:bg-blue-600 dark:hover:bg-gray-700 flex items-center",onClick:()=>b(!1),children:[a.jsx(x.Z,{size:18,className:"mr-2"}),"設定"]}),(0,a.jsxs)("button",{onClick:()=>{b(!1),y()},className:"block w-full text-left px-3 py-2 rounded text-white hover:bg-blue-600 dark:hover:bg-gray-700 flex items-center",children:[a.jsx(h.Z,{size:18,className:"mr-2"}),"ログアウト"]})]})})]})}},65519:(e,t,r)=>{"use strict";r.d(t,{Z:()=>j});var a=r(10326),s=r(17577),l=r(35047),d=r(76),o=r(81540),n=r(13255),i=r(94629),c=r(82433),x=r(9622);function h({personId:e}){let[t,r]=(0,s.useState)(!1),[l,i]=(0,s.useState)(""),[c,h]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),[g,b]=(0,s.useState)(!1),[y,p]=(0,s.useState)(null),[k,f]=(0,s.useState)(!0),j=(0,s.useRef)(null),v=async e=>{try{let t=e.split(/[。.!?！？]/g).filter(e=>e.trim().length>0);if(0===t.length){h("会話の内容から要点を抽出できませんでした。手動で入力してください。");return}let r=t.slice(0,Math.min(4,t.length)).map((e,t)=>`${t+1}. ${e.trim()}`).join("\n");h(r)}catch(e){console.error("Error generating summary:",e),h("要約の生成に失敗しました。手動で要約を入力してください。")}finally{m(!1)}},w=async()=>{if(!l||!c){alert("記録と要約を生成してください");return}b(!0);try{await (0,d.ET)((0,d.hJ)(o.db,"conversations"),{personId:e,transcript:l,summary:c,date:(0,n.WU)(new Date,"yyyy/MM/dd"),timestamp:new Date().toISOString()}),await (0,d.r7)((0,d.JU)(o.db,"homelessPeople",e),{lastSeen:(0,n.WU)(new Date,"yyyy/MM/dd HH:mm")}),alert("会話が保存されました"),i(""),h("")}catch(e){console.error("Error saving conversation:",e),alert("会話の保存中にエラーが発生しました")}finally{b(!1)}};return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"会話を記録"}),!k&&a.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-300 p-4 mb-4",children:a.jsx("p",{children:"お使いのブラウザは音声認識をサポートしていません。Chrome、Edge、またはSafariの最新版をご使用ください。"})}),a.jsx("div",{className:"mb-6",children:t?(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"flex space-x-1 mb-4",children:[a.jsx(x.E.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1.5},className:"w-3 h-3 bg-red-500 rounded-full"}),a.jsx(x.E.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1.5,delay:.2},className:"w-3 h-3 bg-red-500 rounded-full"}),a.jsx(x.E.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1.5,delay:.4},className:"w-3 h-3 bg-red-500 rounded-full"})]}),a.jsx("button",{onClick:()=>{r(!1),m(!0),j.current&&j.current.stop(),l?v(l):m(!1)},className:"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white font-bold py-2 px-4 rounded",children:"録音を停止"}),a.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300 text-sm",children:"音声を認識しています..."})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[a.jsx("button",{onClick:()=>{if(!k){alert("お使いのブラウザはWeb Speech APIをサポートしていません。Chrome、Edge、Safariなどの最新のブラウザをご使用ください。");return}i(""),h(""),r(!0);try{let e=window.SpeechRecognition||window.webkitSpeechRecognition;j.current=new e;let a=j.current;a.continuous=!0,a.interimResults=!0,a.lang="ja-JP",a.onresult=e=>{let t="";for(let r=0;r<e.results.length;r++)e.results[r].isFinal&&(t+=e.results[r][0].transcript);""!==t&&i(e=>e+t)},a.onerror=e=>{console.error("Speech recognition error",e),r(!1),alert(`音声認識エラー: ${e.error||"不明なエラー"}`)},a.onend=()=>{if(t)try{a.start()}catch(e){console.error("再起動エラー:",e),r(!1)}},a.start()}catch(e){console.error("Error starting speech recognition:",e),alert("音声認識の開始に失敗しました。ブラウザがWeb Speech APIをサポートしていない可能性があります。"),r(!1)}},className:"bg-blue-500 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-800 text-white font-bold py-2 px-4 rounded",disabled:u||g,children:u?"処理中...":"録音を開始"}),a.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300 text-sm",children:"ボタンをクリックして会話の録音を開始してください"})]})}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"会話の記録:"}),a.jsx("textarea",{value:l,onChange:e=>i(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:6,placeholder:"録音した会話の文字起こしがここに表示されます。直接編集することもできます。",disabled:t||u||g})]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"会話の要約:"}),a.jsx("textarea",{value:c,onChange:e=>h(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:4,placeholder:"会話の要点を自動的に抽出します。必要に応じて編集してください。",disabled:t||u||g})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:w,className:"bg-green-500 hover:bg-green-700 dark:bg-green-600 dark:hover:bg-green-800 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline disabled:opacity-50",disabled:t||u||g||!l||!c,children:g?"保存中...":"会話を保存"})})]})}var u=r(94019);function m({conversation:e,onClose:t,onSuccess:r}){let[l,n]=(0,s.useState)(e.transcript),[i,c]=(0,s.useState)(e.summary),[x,h]=(0,s.useState)(!1),[m,g]=(0,s.useState)(null),b=async t=>{if(t.preventDefault(),h(!0),g(null),!l.trim()||!i.trim()){g("文字起こしと要約は必須項目です"),h(!1);return}try{let t=(0,d.JU)(o.db,"conversations",e.id);await (0,d.r7)(t,{transcript:l,summary:i}),r()}catch(e){console.error("会話の更新に失敗しました:",e),g("会話の更新中にエラーが発生しました。後でもう一度お試しください。")}finally{h(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b dark:border-gray-700",children:[a.jsx("h2",{className:"text-xl font-bold dark:text-white",children:"会話の編集"}),a.jsx("button",{onClick:t,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:a.jsx(u.Z,{size:24})})]}),(0,a.jsxs)("form",{onSubmit:b,className:"p-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"日付"}),a.jsx("input",{type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:e.date,disabled:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"transcript",children:"文字起こし"}),a.jsx("textarea",{id:"transcript",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:l,onChange:e=>n(e.target.value),rows:6,required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",htmlFor:"summary",children:"要約"}),a.jsx("textarea",{id:"summary",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:i,onChange:e=>c(e.target.value),rows:4,required:!0})]}),m&&a.jsx("div",{className:"mb-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded",children:m}),(0,a.jsxs)("div",{className:"flex justify-end",children:[a.jsx("button",{type:"button",onClick:t,className:"bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-bold py-2 px-4 rounded mr-2 focus:outline-none focus:shadow-outline",disabled:x,children:"キャンセル"}),a.jsx("button",{type:"submit",className:"bg-blue-500 dark:bg-blue-600 hover:bg-blue-700 dark:hover:bg-blue-800 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",disabled:x,children:x?"保存中...":"保存"})]})]})]})})}var g=r(85529),b=r(77636),y=r(69508),p=r(47035),k=r(39183),f=r(46226);function j({personId:e,isPopup:t=!1}){var r;let[x,u]=(0,s.useState)(null),[j,v]=(0,s.useState)([]),[w,N]=(0,s.useState)(!0),[C,S]=(0,s.useState)(null),[P,E]=(0,s.useState)("details"),[Z,$]=(0,s.useState)(null),[U,L]=(0,s.useState)(!1),[M,R]=(0,s.useState)(!1),[z,I]=(0,s.useState)(null),T=(0,l.useRouter)(),F=async()=>{if(Z&&e){L(!0),R(!1);try{let t=(0,d.JU)(o.db,"homelessPeople",e),{id:r,location:a,...s}=Z;await (0,d.r7)(t,s),R(!0),u(Z),setTimeout(()=>{R(!1)},3e3)}catch(e){console.error("Error updating person:",e),S("データの更新中にエラーが発生しました")}finally{L(!1)}}},A=e=>{try{return(0,n.WU)((0,i.D)(e),"yyyy年MM月dd日",{locale:c.ja})}catch{return e}},W=(e,r)=>{if(t){window.dispatchEvent(new CustomEvent("show-location",{detail:{latitude:e,longitude:r}}));let t=document.querySelector("[data-close-popup]");t&&t.click()}else T.push(`/?lat=${e}&lng=${r}`)},G=async()=>{if(window.confirm(`${x?.nickname}の情報を削除しますか？`)){L(!0);try{await (0,d.oe)((0,d.JU)(o.db,"homelessPeople",e)),T.refresh()}catch(e){console.error("Error deleting document: ",e),alert("削除中にエラーが発生しました。")}finally{L(!1)}}};return w?(0,a.jsxs)("div",{className:"flex justify-center items-center h-64",children:[a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"データを読み込み中..."})]}):C||!x?(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[a.jsx("p",{children:C||"データが見つかりません"}),!t&&a.jsx("button",{className:"mt-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:()=>T.push("/"),children:"マップに戻る"})]}):(0,a.jsxs)("div",{className:t?"w-full":"container mx-auto p-4 max-w-4xl",children:[!t&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[a.jsx("div",{className:"p-4 bg-blue-500 dark:bg-gray-700 text-black dark:text-white",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[x.photoURL?a.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden mr-3",children:a.jsx(f.default,{src:x.photoURL,alt:x.nickname,width:48,height:48,className:"object-cover w-full h-full"})}):a.jsx(g.Z,{className:"w-12 h-12 mr-3 text-white"}),a.jsx("h1",{className:"text-2xl font-bold",children:x.nickname})]}),a.jsx("button",{className:"bg-white dark:bg-gray-600 text-blue-500 dark:text-white px-3 py-1 rounded hover:bg-blue-100 dark:hover:bg-gray-500",onClick:()=>T.push("/"),children:"マップに戻る"})]})}),a.jsx("div",{className:"border-b dark:border-gray-700",children:(0,a.jsxs)("nav",{className:"flex",children:[a.jsx("button",{className:`px-4 py-2 border-r dark:border-gray-700 ${"details"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("details"),children:"基本情報"}),(0,a.jsxs)("button",{className:`px-4 py-2 border-r dark:border-gray-700 ${"conversations"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("conversations"),children:["会話履歴 (",j.length,")"]}),a.jsx("button",{className:`px-4 py-2 border-r dark:border-gray-700 ${"recorder"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("recorder"),children:"会話を記録"}),a.jsx("button",{className:`px-4 py-2 ${"edit"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("edit"),children:"編集"})]})})]}),t&&(0,a.jsxs)("div",{className:"border-b dark:border-gray-700 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[x.photoURL?a.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden mr-3",children:a.jsx(f.default,{src:x.photoURL,alt:x.nickname,width:40,height:40,className:"object-cover w-full h-full"})}):a.jsx(g.Z,{className:"w-10 h-10 mr-3 text-gray-400"}),a.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:x.nickname})]}),(0,a.jsxs)("nav",{className:"flex mb-2",children:[a.jsx("button",{className:`px-4 py-2 border-r dark:border-gray-700 ${"details"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("details"),children:"基本情報"}),(0,a.jsxs)("button",{className:`px-4 py-2 border-r dark:border-gray-700 ${"conversations"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("conversations"),children:["会話履歴 (",j.length,")"]}),a.jsx("button",{className:`px-4 py-2 border-r dark:border-gray-700 ${"recorder"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("recorder"),children:"会話を記録"}),a.jsx("button",{className:`px-4 py-2 ${"edit"===P?"bg-blue-100 dark:bg-blue-900 font-bold text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>E("edit"),children:"編集"})]})]}),(0,a.jsxs)("div",{className:t?"":"p-4",children:["details"===P&&a.jsx("div",{className:"space-y-4",children:(0,a.jsxs)("dl",{children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"ニックネーム"}),(0,a.jsxs)("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2 flex items-center",children:[x.photoURL?a.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden mr-2",children:a.jsx(f.default,{src:x.photoURL,alt:x.nickname,width:32,height:32,className:"object-cover w-full h-full"})}):a.jsx(g.Z,{className:"w-8 h-8 mr-2 text-gray-400"}),x.nickname]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"年齢層"}),a.jsx("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2",children:x.ageGroup||"不明"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"カテゴリ"}),a.jsx("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2",children:{regular:"定期的に会う（赤）",occasional:"たまに会う（黄）",new:"新規（緑）"}[r=x.category]||r})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"最終確認日"}),a.jsx("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2",children:x.lastSeen})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"位置情報"}),a.jsx("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2",children:x.locations&&x.locations.length>0?a.jsx("div",{className:"space-y-2",children:x.locations.map((e,t)=>(0,a.jsxs)("div",{className:"border-l-4 border-blue-500 pl-3 py-1",children:[a.jsx("div",{className:"font-medium",children:e.description||`位置 ${t+1}`}),(0,a.jsxs)("button",{onClick:()=>W(e.latitude,e.longitude),className:"mt-1 flex items-center text-blue-500 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:[a.jsx(b.Z,{size:16,className:"mr-1"}),"マップで表示"]}),e.timestamp&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["記録日: ",A(e.timestamp.toString())]})]},t))}):a.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"位置情報がありません"})})]}),x.features&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"特徴"}),a.jsx("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2",children:x.features})]}),x.photoURL&&(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4",children:[a.jsx("dt",{className:"font-medium text-gray-500 dark:text-gray-400",children:"プロフィール画像"}),a.jsx("dd",{className:"mt-1 text-gray-900 dark:text-white sm:mt-0 sm:col-span-2",children:a.jsx("div",{className:"w-40 h-40 rounded-lg overflow-hidden",children:a.jsx(f.default,{src:x.photoURL,alt:x.nickname,width:160,height:160,className:"object-cover w-full h-full"})})})]})]})}),"conversations"===P&&a.jsx("div",{children:0===j.length?a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"会話履歴がありません"}):a.jsx("ul",{className:"space-y-4",children:j.map(e=>(0,a.jsxs)("li",{className:"border rounded-lg overflow-hidden dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 font-medium flex justify-between items-center",children:[a.jsx("span",{className:"dark:text-white",children:e.date}),(0,a.jsxs)("button",{onClick:()=>I(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 flex items-center text-sm",children:[a.jsx(y.Z,{size:16,className:"mr-1"}),"編集"]})]}),(0,a.jsxs)("div",{className:"p-4 dark:bg-gray-900",children:[a.jsx("h3",{className:"font-bold mb-2 dark:text-white",children:"要約:"}),a.jsx("div",{className:"whitespace-pre-line mb-4 dark:text-gray-300",children:e.summary}),(0,a.jsxs)("details",{className:"bg-gray-50 dark:bg-gray-800 p-2 rounded",children:[a.jsx("summary",{className:"cursor-pointer dark:text-white",children:"文字起こしを表示"}),a.jsx("div",{className:"p-2 mt-2 dark:text-gray-300",children:e.transcript})]})]})]},e.id))})}),"recorder"===P&&a.jsx(h,{personId:e}),"edit"===P&&Z&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow-sm",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"情報を編集"}),(0,a.jsxs)("form",{onSubmit:F,children:[(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-900 dark:text-white text-sm font-bold mb-2",htmlFor:"nickname",children:"ニックネーム"}),a.jsx("input",{id:"nickname",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-900 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:Z.nickname,onChange:e=>$({...Z,nickname:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-900 dark:text-white text-sm font-bold mb-2",htmlFor:"ageGroup",children:"年齢層"}),(0,a.jsxs)("select",{id:"ageGroup",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-900 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:Z.ageGroup||"",onChange:e=>$({...Z,ageGroup:e.target.value}),children:[a.jsx("option",{value:"",children:"不明"}),a.jsx("option",{value:"10代",children:"10代"}),a.jsx("option",{value:"20代",children:"20代"}),a.jsx("option",{value:"30代",children:"30代"}),a.jsx("option",{value:"40代",children:"40代"}),a.jsx("option",{value:"50代",children:"50代"}),a.jsx("option",{value:"60代",children:"60代"}),a.jsx("option",{value:"70代以上",children:"70代以上"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-900 dark:text-white text-sm font-bold mb-2",htmlFor:"category",children:"カテゴリ"}),(0,a.jsxs)("select",{id:"category",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-900 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:Z.category,onChange:e=>$({...Z,category:e.target.value}),children:[a.jsx("option",{value:"new",children:"新規（緑）"}),a.jsx("option",{value:"occasional",children:"たまに会う（黄）"}),a.jsx("option",{value:"regular",children:"定期的に会う（赤）"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-900 dark:text-white text-sm font-bold mb-2",htmlFor:"features",children:"特徴"}),a.jsx("textarea",{id:"features",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-900 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:Z.features||"",onChange:e=>$({...Z,features:e.target.value}),rows:3})]}),x.photoURL&&(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-900 dark:text-white text-sm font-bold mb-2",children:"現在のプロフィール画像"}),a.jsx("div",{className:"w-32 h-32 rounded-lg overflow-hidden",children:a.jsx(f.default,{src:x.photoURL,alt:x.nickname,width:128,height:128,className:"object-cover w-full h-full"})}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"画像を変更するには、新しく登録し直す必要があります。"})]}),M&&a.jsx("div",{className:"mb-4 p-2 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-100 rounded",children:"保存しました"}),(0,a.jsxs)("div",{className:"flex justify-end",children:[a.jsx("button",{type:"button",className:"mr-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-black dark:text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",onClick:()=>E("details"),children:"キャンセル"}),a.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-800 text-black dark:text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",disabled:U,children:U?"保存中...":"保存"})]})]})]})]}),z&&a.jsx(m,{conversation:z,onClose:()=>I(null),onSuccess:()=>{I(null)}}),(0,a.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,a.jsxs)("button",{onClick:G,disabled:U,className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded flex items-center disabled:opacity-50",children:[a.jsx(p.Z,{className:"w-4 h-4 mr-1"}),U?"削除中...":"削除"]}),(0,a.jsxs)("button",{onClick:()=>{T.push(`/person/${e}`)},className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex items-center",children:["詳細 ",a.jsx(k.Z,{className:"w-4 h-4 ml-1"})]})]})]})}},44260:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>n,V:()=>o});var a=r(10326),s=r(17577),l=r(46791),d=r(81540);let o=(0,s.createContext)({user:null,loading:!0,signInWithGoogle:async()=>{},signOut:async()=>{}});function n({children:e}){let[t,r]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0),c=async()=>{let e=new l.hJ;try{await (0,l.rh)(d.I8,e)}catch(e){console.error("Error signing in with Google",e)}},x=async()=>{try{await (0,l.w7)(d.I8)}catch(e){console.error("Error signing out",e)}};return a.jsx(o.Provider,{value:{user:t,loading:n,signInWithGoogle:c,signOut:x},children:e})}},62361:(e,t,r)=>{"use strict";r.d(t,{F:()=>o,ThemeProvider:()=>d});var a=r(10326),s=r(17577);let l=(0,s.createContext)(void 0),d=({children:e})=>{let[t,r]=(0,s.useState)("light");return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e?r(e):t&&r("dark")},[]),(0,s.useEffect)(()=>{"dark"===t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",t)},[t]),a.jsx(l.Provider,{value:{theme:t,toggleTheme:()=>{r(e=>"light"===e?"dark":"light")}},children:e})},o=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},81540:(e,t,r)=>{"use strict";r.d(t,{I8:()=>n,db:()=>i,tO:()=>c});var a=r(42585),s=r(46791),l=r(76),d=r(11552);let o=(0,a.C6)().length?(0,a.Mq)():(0,a.ZF)({apiKey:"AIzaSyB5y7Hl1TkxMnT6m1YCwFXONgvy6yUKhbo",authDomain:"oikos-4bf07.firebaseapp.com",projectId:"oikos-4bf07",storageBucket:"oikos-4bf07.firebasestorage.app",messagingSenderId:"1081771625262",appId:"1:1081771625262:web:863be88a259d66a88688bf"}),n=(0,s.v0)(o),i=(0,l.ad)(o),c=(0,d.cF)(o)},54733:(e,t,r)=>{"use strict";r.d(t,{a:()=>l});var a=r(17577),s=r(44260);let l=()=>(0,a.useContext)(s.V)},80349:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b,metadata:()=>g});var a=r(19510),s=r(45317),l=r.n(s);r(5023);var d=r(68570);let o=(0,d.createProxy)(String.raw`/home/runner/work/oikochu/oikochu/src/lib/contexts/AuthContext.tsx`),{__esModule:n,$$typeof:i}=o;o.default;let c=(0,d.createProxy)(String.raw`/home/runner/work/oikochu/oikochu/src/lib/contexts/AuthContext.tsx#AuthProvider`);(0,d.createProxy)(String.raw`/home/runner/work/oikochu/oikochu/src/lib/contexts/AuthContext.tsx#AuthContext`);let x=(0,d.createProxy)(String.raw`/home/runner/work/oikochu/oikochu/src/lib/contexts/ThemeContext.tsx`),{__esModule:h,$$typeof:u}=x;x.default;let m=(0,d.createProxy)(String.raw`/home/runner/work/oikochu/oikochu/src/lib/contexts/ThemeContext.tsx#ThemeProvider`);(0,d.createProxy)(String.raw`/home/runner/work/oikochu/oikochu/src/lib/contexts/ThemeContext.tsx#useTheme`);let g={title:"ホームレス支援アプリ",description:"ホームレスの人々の情報を管理し支援するためのアプリケーション"};function b({children:e}){return a.jsx("html",{lang:"ja",className:"h-full",children:a.jsx("body",{className:`${l().className} h-full dark:bg-gray-900 dark:text-white transition-colors duration-200`,children:a.jsx(c,{children:a.jsx(m,{children:e})})})})}},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(66621);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};