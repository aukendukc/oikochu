(()=>{var e={};e.id=554,e.ids=[554],e.modules={2006:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=2006,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},73515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>p,staticGenerationAsyncStorage:()=>f});var i={};r.r(i),r.d(i,{POST:()=>u});var n=r(49303),s=r(88716),a=r(60670),o=r(87070),c=r(9185);let l=new(r.n(c)())({auth:process.env.REPLICATE_API_TOKEN});async function u(e){if(!process.env.REPLICATE_API_TOKEN)throw Error("The REPLICATE_API_TOKEN environment variable is not set. See README.md for instructions on how to set it.");let{prompt:t}=await e.json();try{let e=await l.run("stability-ai/stable-diffusion:db21e45d3f7023abc2a46ee38a23973f6dce16bb082a930b0c49861f96d1e5bf",{input:{prompt:t,image_dimensions:"512x512",num_outputs:1,num_inference_steps:50,guidance_scale:7.5,scheduler:"DPMSolverMultistep"}});return o.NextResponse.json({output:e},{status:200})}catch(e){return console.error("Error from Replicate API:",e),o.NextResponse.json({error:e.message},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/replicate/generate-image/route",pathname:"/api/replicate/generate-image",filename:"route",bundlePath:"app/api/replicate/generate-image/route"},resolvedPagePath:"/home/runner/work/oikochu/oikochu/src/app/api/replicate/generate-image/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:p}=d,m="/api/replicate/generate-image/route";function w(){return(0,a.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:f})}},9185:(e,t,r)=>{let i=r(98778),n=r(95305),{createReadableStream:s}=r(78995),{withAutomaticRetries:a,validateWebhook:o,parseProgressFromLogs:c,streamAsyncIterator:l}=r(87895),u=r(2193),d=r(16693),h=r(2441),f=r(45233),p=r(9046),m=r(78212),w=r(16915),y=r(29019),b=r(67930),g=r(69637);class v{constructor(e={}){this.auth=e.auth||("undefined"!=typeof process?process.env.REPLICATE_API_TOKEN:null),this.userAgent=e.userAgent||`replicate-javascript/${g.version}`,this.baseUrl=e.baseUrl||"https://api.replicate.com/v1",this.fetch=e.fetch||globalThis.fetch,this.fileEncodingStrategy=e.fileEncodingStrategy??"default",this.accounts={current:u.current.bind(this)},this.collections={list:d.list.bind(this),get:d.get.bind(this)},this.deployments={get:h.get.bind(this),create:h.create.bind(this),update:h.update.bind(this),delete:h.delete.bind(this),list:h.list.bind(this),predictions:{create:h.predictions.create.bind(this)}},this.files={create:f.create.bind(this),get:f.get.bind(this),list:f.list.bind(this),delete:f.delete.bind(this)},this.hardware={list:p.list.bind(this)},this.models={get:m.get.bind(this),list:m.list.bind(this),create:m.create.bind(this),versions:{list:m.versions.list.bind(this),get:m.versions.get.bind(this)},search:m.search.bind(this)},this.predictions={create:w.create.bind(this),get:w.get.bind(this),cancel:w.cancel.bind(this),list:w.list.bind(this)},this.trainings={create:y.create.bind(this),get:y.get.bind(this),cancel:y.cancel.bind(this),list:y.list.bind(this)},this.webhooks={default:{secret:{get:b.default.secret.get.bind(this)}}}}async run(e,t,r){let i;let{wait:s,signal:a,...o}=t,c=n.parse(e);if(c.version)i=await this.predictions.create({...o,version:c.version});else if(c.owner&&c.name)i=await this.predictions.create({...o,model:`${c.owner}/${c.name}`});else throw Error("Invalid model version identifier");if(r&&r(i),i=await this.wait(i,s||{},async e=>(r&&r(e),!!a&&!!a.aborted)),a&&a.aborted&&(i=await this.predictions.cancel(i.id)),r&&r(i),"failed"===i.status)throw Error(`Prediction failed: ${i.error}`);return i.output}async request(e,t){let r,n;let{auth:s,baseUrl:o,userAgent:c}=this;e instanceof URL?r=e:r=new URL(e.startsWith("/")?e.slice(1):e,o.endsWith("/")?o:`${o}/`);let{method:l="GET",params:u={},data:d}=t;for(let[e,t]of Object.entries(u))r.searchParams.append(e,t);let h={"Content-Type":"application/json","User-Agent":c};if(s&&(h.Authorization=`Bearer ${s}`),t.headers)for(let[e,r]of Object.entries(t.headers))h[e]=r;d instanceof FormData?(n=d,delete h["Content-Type"]):d&&(n=JSON.stringify(d));let f={method:l,headers:h,body:n},p=this.fetch,m=await a(async()=>p(r,f),{shouldRetry:"GET"===l?e=>429===e.status||e.status>=500:e=>429===e.status});if(!m.ok){let e=new Request(r,f),t=await m.text();throw new i(`Request to ${r} failed with status ${m.status} ${m.statusText}: ${t}.`,e,m)}return m}async *stream(e,t){let r;let{wait:i,signal:a,...o}=t,c=n.parse(e);if(c.version)r=await this.predictions.create({...o,version:c.version,stream:!0});else if(c.owner&&c.name)r=await this.predictions.create({...o,model:`${c.owner}/${c.name}`,stream:!0});else throw Error("Invalid model version identifier");if(r.urls&&r.urls.stream){let e=s({url:r.urls.stream,fetch:this.fetch,...a?{options:{signal:a}}:{}});yield*l(e)}else throw Error("Prediction does not support streaming")}async *paginate(e){let t=await e();yield t.results,t.next&&(yield*this.paginate(()=>this.request(t.next,{method:"GET"}).then(e=>e.json())))}async wait(e,t,r){let{id:i}=e;if(!i)throw Error("Invalid prediction");if("succeeded"===e.status||"failed"===e.status||"canceled"===e.status)return e;let n=e=>new Promise(t=>setTimeout(t,e)),s=t&&t.interval||500,a=await this.predictions.get(i);for(;"succeeded"!==a.status&&"failed"!==a.status&&"canceled"!==a.status&&(!r||await r(a)!==!0);)await n(s),a=await this.predictions.get(e.id);if("failed"===a.status)throw Error(`Prediction failed: ${a.error}`);return a}}e.exports=v,e.exports.validateWebhook=o,e.exports.parseProgressFromLogs=c},2193:e=>{async function t(){return(await this.request("/account",{method:"GET"})).json()}e.exports={current:t}},16693:e=>{async function t(e){return(await this.request(`/collections/${e}`,{method:"GET"})).json()}async function r(){return(await this.request("/collections",{method:"GET"})).json()}e.exports={get:t,list:r}},2441:(e,t,r)=>{let{transformFileInputs:i}=r(87895);async function n(e,t,r){let{stream:n,input:s,...a}=r;if(a.webhook)try{new URL(a.webhook)}catch(e){throw Error("Invalid webhook URL")}return(await this.request(`/deployments/${e}/${t}/predictions`,{method:"POST",data:{...a,input:await i(this,s,this.fileEncodingStrategy),stream:n}})).json()}async function s(e,t){return(await this.request(`/deployments/${e}/${t}`,{method:"GET"})).json()}async function a(e){return(await this.request("/deployments",{method:"POST",data:e})).json()}async function o(e,t,r){return(await this.request(`/deployments/${e}/${t}`,{method:"PATCH",data:r})).json()}async function c(e,t){return 204===(await this.request(`/deployments/${e}/${t}`,{method:"DELETE"})).status}async function l(){return(await this.request("/deployments",{method:"GET"})).json()}e.exports={predictions:{create:n},get:s,create:a,update:o,list:l,delete:c}},98778:e=>{class t extends Error{constructor(e,t,r){super(e),this.name="ApiError",this.request=t,this.response=r}}e.exports=t},45233:e=>{async function t(e,t={}){let r,i;let n=new FormData;if(e instanceof Blob)r=e.name||`blob_${Date.now()}`,i=e;else if(Buffer.isBuffer(e))r=`buffer_${Date.now()}`,i=new Blob([new Uint8Array(e)],{type:"application/octet-stream",name:r});else throw Error("Invalid file argument, must be a Blob, File or Buffer");return n.append("content",i,r),n.append("metadata",new Blob([JSON.stringify(t)],{type:"application/json"})),(await this.request("/files",{method:"POST",data:n,headers:{"Content-Type":"multipart/form-data"}})).json()}async function r(){return(await this.request("/files",{method:"GET"})).json()}async function i(e){return(await this.request(`/files/${e}`,{method:"GET"})).json()}async function n(e){return 204===(await this.request(`/files/${e}`,{method:"DELETE"})).status}e.exports={create:t,list:r,get:i,delete:n}},9046:e=>{async function t(){return(await this.request("/hardware",{method:"GET"})).json()}e.exports={list:t}},95305:e=>{class t{constructor(e,t,r=null){this.owner=e,this.name=t,this.version=r}static parse(e){let r=e.match(/^(?<owner>[^/]+)\/(?<name>[^/:]+)(:(?<version>.+))?$/);if(!r)throw Error(`Invalid reference to model version: ${e}. Expected format: owner/name or owner/name:version`);let{owner:i,name:n,version:s}=r.groups;return new t(i,n,s)}}e.exports=t},78212:e=>{async function t(e,t){return(await this.request(`/models/${e}/${t}`,{method:"GET"})).json()}async function r(e,t){return(await this.request(`/models/${e}/${t}/versions`,{method:"GET"})).json()}async function i(e,t,r){return(await this.request(`/models/${e}/${t}/versions/${r}`,{method:"GET"})).json()}async function n(){return(await this.request("/models",{method:"GET"})).json()}async function s(e,t,r){let i={owner:e,name:t,...r};return(await this.request("/models",{method:"POST",data:i})).json()}async function a(e){return(await this.request("/models",{method:"QUERY",headers:{"Content-Type":"text/plain"},data:e})).json()}e.exports={get:t,list:n,create:s,versions:{list:r,get:i},search:a}},16915:(e,t,r)=>{let{transformFileInputs:i}=r(87895);async function n(e){let t;let{model:r,version:n,stream:s,input:a,...o}=e;if(o.webhook)try{new URL(o.webhook)}catch(e){throw Error("Invalid webhook URL")}if(n)t=await this.request("/predictions",{method:"POST",data:{...o,input:await i(this,a,this.fileEncodingStrategy),version:n,stream:s}});else if(r)t=await this.request(`/models/${r}/predictions`,{method:"POST",data:{...o,input:await i(this,a,this.fileEncodingStrategy),stream:s}});else throw Error("Either model or version must be specified");return t.json()}async function s(e){return(await this.request(`/predictions/${e}`,{method:"GET"})).json()}async function a(e){return(await this.request(`/predictions/${e}/cancel`,{method:"POST"})).json()}async function o(){return(await this.request("/predictions",{method:"GET"})).json()}e.exports={create:n,get:s,cancel:a,list:o}},78995:(e,t,r)=>{let i=r(98778),{streamAsyncIterator:n}=r(87895),{EventSourceParserStream:s}=r(43745),{TextDecoderStream:a}=void 0===globalThis.TextDecoderStream?r(67601):globalThis;class o{constructor(e,t,r,i){this.event=e,this.data=t,this.id=r,this.retry=i}toString(){return"output"===this.event?this.data:""}}e.exports={createReadableStream:function({url:e,fetch:t,options:r={}}){return new ReadableStream({async start(c){let l={...r,headers:{...r.headers,Accept:"text/event-stream"}},u=await t(e,l);if(!u.ok){let t=await u.text(),r=new Request(e,l);c.error(new i(`Request to ${e} failed with status ${u.status}: ${t}`,r,u))}for await(let e of n(u.body.pipeThrough(new a).pipeThrough(new s))){if("error"===e.event){c.error(Error(e.data));break}if(c.enqueue(new o(e.event,e.data,e.id)),"done"===e.event)break}c.close()}})},ServerSentEvent:o}},29019:e=>{async function t(e,t,r,i){let{...n}=i;if(n.webhook)try{new URL(n.webhook)}catch(e){throw Error("Invalid webhook URL")}return(await this.request(`/models/${e}/${t}/versions/${r}/trainings`,{method:"POST",data:n})).json()}async function r(e){return(await this.request(`/trainings/${e}`,{method:"GET"})).json()}async function i(e){return(await this.request(`/trainings/${e}/cancel`,{method:"POST"})).json()}async function n(){return(await this.request("/trainings",{method:"GET"})).json()}e.exports={create:t,get:r,cancel:i,list:n}},87895:(e,t,r)=>{let i=r(98778),{create:n}=r(45233);async function s(e,t){let{id:r,timestamp:i,body:n,signature:s}=e,o=t||e.secret;if(e&&e.headers&&e.body&&("function"==typeof e.headers.get?(r=e.headers.get("webhook-id"),i=e.headers.get("webhook-timestamp"),s=e.headers.get("webhook-signature")):(r=e.headers["webhook-id"],i=e.headers["webhook-timestamp"],s=e.headers["webhook-signature"]),n=e.body),n instanceof ReadableStream||n.readable)try{n=await new Response(n).text()}catch(e){throw Error(`Error reading body: ${e.message}`)}else if(f(n))n=await new Blob([n]).text();else if("object"==typeof n)n=JSON.stringify(n);else if("string"!=typeof n)throw Error("Invalid body type");if(!r||!i||!s)throw Error("Missing required webhook headers");if(!n)throw Error("Missing required body");if(!o)throw Error("Missing required secret");let c=`${r}.${i}.${n}`,l=await a(o.split("_").pop(),c);return s.split(" ").map(e=>e.split(",")[1]).some(e=>e===l)}async function a(e,t){let i=new TextEncoder,n=globalThis.crypto;void 0===n&&(n=r(2006).call(null,"node:crypto").webcrypto);let s=await n.subtle.importKey("raw",Uint8Array.from(atob(e),e=>e.codePointAt(0)),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return o(await n.subtle.sign("HMAC",s,i.encode(t)))}function o(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}async function c(e,t={}){let r=t.shouldRetry||(()=>!1),n=t.maxRetries||5,s=t.interval||500,a=t.jitter||100,o=e=>new Promise(t=>setTimeout(t,e)),c=0;do{let l=s*2**c+Math.random()*a;try{let t=await e();if(t.ok||!r(t))return t}catch(e){if(e instanceof i){let t=e.response.headers.get("Retry-After");if(t){if(Number.isInteger(t))l=1e3*t;else{let e=new Date(t);Number.isNaN(e.getTime())||(l=e.getTime()-new Date().getTime())}}}}Number.isInteger(n)&&n>0&&(Number.isInteger(l)&&l>0&&await o(s*2**(t.maxRetries-n)),c+=1)}while(c<n);return e()}async function l(e,t,r){switch(r){case"data-uri":return await d(e,t);case"upload":return await u(e,t);case"default":try{return await u(e,t)}catch(e){if(e instanceof i&&e.response.status>=400&&e.response.status<500)throw e;return await d(t)}default:throw Error(`Unexpected file upload strategy: ${r}`)}}async function u(e,t){return await h(t,async t=>t instanceof Blob||t instanceof Buffer?(await n.call(e,t)).urls.get:t)}async function d(e){let t=0;return await h(e,async e=>{let r,i;if(e instanceof Blob)r=await e.arrayBuffer(),i=e.type;else{if(!f(e))return e;r=e}if((t+=r.byteLength)>1e7)throw Error(`Combined filesize of prediction ${t} bytes exceeds 10mb limit for inline encoding, please provide URLs instead`);let n=o(r);return i=i??"application/octet-stream",`data:${i};base64,${n}`})}async function h(e,t){if(Array.isArray(e)){let r=[];for(let i of e){let e=await h(i,t);r.push(e)}return r}if(function(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==String(e))return!1;let t=Object.getPrototypeOf(e);if(null===t)return!0;let r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.toString.call(r)===Function.prototype.toString.call(Object)}(e)){let r={};for(let i of Object.keys(e))r[i]=await h(e[i],t);return r}return await t(e)}function f(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}async function*p(e){let t=e.getReader();try{for(;;){let{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}e.exports={transformFileInputs:l,validateWebhook:s,withAutomaticRetries:c,parseProgressFromLogs:function(e){let t="object"==typeof e&&e.logs?e.logs:e;if(!t||"string"!=typeof t)return null;let r=/^\s*(\d+)%\s*\|.+?\|\s*(\d+)\/(\d+)/;for(let e of t.split("\n").reverse()){let t=e.match(r);if(t&&4===t.length)return{percentage:parseInt(t[1],10)/100,current:parseInt(t[2],10),total:parseInt(t[3],10)}}return null},streamAsyncIterator:p}},67930:e=>{async function t(){return(await this.request("/webhooks/default/secret",{method:"GET"})).json()}e.exports={default:{secret:{get:t}}}},43745:e=>{var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,s={};((e,r)=>{for(var i in r)t(e,i,{get:r[i],enumerable:!0})})(s,{EventSourceParserStream:()=>o}),e.exports=((e,s,a,o)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let a of i(s))n.call(e,a)||void 0===a||t(e,a,{get:()=>s[a],enumerable:!(o=r(s,a))||o.enumerable});return e})(t({},"__esModule",{value:!0}),s);var a=[239,187,191],o=class extends TransformStream{constructor(){let e;super({start(t){e=function(e){let t,r,i,n,s,o,c;return l(),{feed:function(l){var u;r=r?r+l:l,t&&(u=r,a.every((e,t)=>u.charCodeAt(t)===e))&&(r=r.slice(a.length)),t=!1;let d=r.length,h=0,f=!1;for(;h<d;){let t;f&&("\n"===r[h]&&++h,f=!1);let a=-1,l=n;for(let e=i;a<0&&e<d;++e)":"===(t=r[e])&&l<0?l=e-h:"\r"===t?(f=!0,a=e-h):"\n"===t&&(a=e-h);if(a<0){i=d-h,n=l;break}i=0,n=-1,function(t,r,i,n){if(0===n){c.length>0&&(e({type:"event",id:s,event:o||void 0,data:c.slice(0,-1)}),c="",s=void 0),o=void 0;return}let a=i<0,l=t.slice(r,r+(a?n:i)),u=0;u=a?n:" "===t[r+i+1]?i+2:i+1;let d=r+u,h=n-u,f=t.slice(d,d+h).toString();if("data"===l)c+=f?"".concat(f,"\n"):"\n";else if("event"===l)o=f;else if("id"!==l||f.includes("\0")){if("retry"===l){let t=parseInt(f,10);Number.isNaN(t)||e({type:"reconnect-interval",value:t})}}else s=f}(r,h,l,a),h+=a+1}h===d?r="":h>0&&(r=r.slice(h))},reset:l};function l(){t=!0,r="",i=0,n=-1,s=void 0,o=void 0,c=""}}(e=>{"event"===e.type&&t.enqueue(e)})},transform(t){e.feed(t)}})}}},67601:e=>{var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,s={};((e,r)=>{for(var i in r)t(e,i,{get:r[i],enumerable:!0})})(s,{TextDecoderStream:()=>l}),e.exports=((e,s,a,o)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let a of i(s))n.call(e,a)||void 0===a||t(e,a,{get:()=>s[a],enumerable:!(o=r(s,a))||o.enumerable});return e})(t({},"__esModule",{value:!0}),s);var a=Symbol("decDecoder"),o=Symbol("decTransform"),c=class{constructor(e){this.decoder_=e}transform(e,t){if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw TypeError("Input data must be a BufferSource");let r=this.decoder_.decode(e,{stream:!0});0!==r.length&&t.enqueue(r)}flush(e){let t=this.decoder_.decode();0!==t.length&&e.enqueue(t)}},l=class{constructor(e,t){let r=new TextDecoder(e||"utf-8",t||{});this[a]=r,this[o]=new TransformStream(new c(r))}get encoding(){return this[a].encoding}get fatal(){return this[a].fatal}get ignoreBOM(){return this[a].ignoreBOM}get readable(){return this[o].readable}get writable(){return this[o].writable}};Symbol("encEncoder"),Symbol("encTransform")},69637:e=>{"use strict";e.exports=JSON.parse('{"name":"replicate","version":"0.32.1","description":"JavaScript client for Replicate","repository":"github:replicate/replicate-javascript","homepage":"https://github.com/replicate/replicate-javascript#readme","bugs":"https://github.com/replicate/replicate-javascript/issues","license":"Apache-2.0","main":"index.js","type":"commonjs","types":"index.d.ts","files":["CONTRIBUTING.md","LICENSE","README.md","index.d.ts","index.js","lib/**/*.js","vendor/**/*","package.json"],"engines":{"node":">=18.0.0","npm":">=7.19.0","git":">=2.11.0","yarn":">=1.7.0"},"scripts":{"check":"tsc","format":"biome format . --write","lint-biome":"biome lint .","lint-publint":"publint","lint":"npm run lint-biome && npm run lint-publint","test":"jest"},"optionalDependencies":{"readable-stream":">=4.0.0"},"devDependencies":{"@biomejs/biome":"^1.4.1","@types/jest":"^29.5.3","@typescript-eslint/eslint-plugin":"^5.56.0","cross-fetch":"^3.1.5","jest":"^29.7.0","nock":"^14.0.0-beta.6","publint":"^0.2.7","ts-jest":"^29.1.0","typescript":"^5.0.2"}}')}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[948,972],()=>r(73515));module.exports=i})();